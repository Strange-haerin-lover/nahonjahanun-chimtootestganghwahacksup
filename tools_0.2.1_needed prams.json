{
  "globals": {
    "default_timing": {"type": "timing", "default": "T3", "desc": "기본 타이밍 프로파일"},
    "output_dir": {"type": "string", "default": "./scan_out", "desc": "출력 저장 디렉토리"}
  },
  "types_summary": {
    "ip_target": {"desc": "IPv4/도메인 또는 IPv4/CIDR", "validation": "regex"},
    "ip_targets": {"desc": "공백으로 구분된 다중 타겟", "validation": "regex"},
    "port": {"desc": "단일 포트(1-65535)", "validation": "regex"},
    "port_list": {"desc": "쉼표로 구분된 포트 리스트(각 1-65535)", "validation": "regex"},
    "top_n": {"desc": "상위 포트 개수", "validation": "range [1,10000]"},
    "timing": {"desc": "스캔 속도 프로파일", "enum": ["T0","T1","T2","T3","T4","T5"]},
    "bool": {"desc": "불리언", "enum": [true,false]},
    "rate": {"desc": "초당 패킷 수", "validation": "range [1,100000]"},
    "retry_count": {"desc": "재시도 횟수", "validation": "range [0,20]"},
    "seconds": {"desc": "초 단위 시간", "validation": "range [1,3600]"},
    "filename": {"desc": "출력 파일 접두어(안전문자)", "validation": "regex"},
    "nse_category": {"desc": "NSE 스크립트 카테고리", "enum": ["auth","broadcast","brute","default","discovery","dos","exploit","external","fuzzer","intrusive","malware","safe","version","vuln"]}
  },
  "actions": {
    "host_discovery": {
      "desc": "핑 스윕(호스트 생존 확인)",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"timing","type":"timing","required":false},
        {"name":"save","type":"bool","required":false,"default":false},
        {"name":"out_prefix","type":"filename","required":false,"default":"host_discovery"}
      ]
    },
    "tcp_syn_top": {
      "desc": "TCP SYN 상위 N 포트",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"top_n","type":"top_n","required":true},
        {"name":"timing","type":"timing","required":false},
        {"name":"no_ping","type":"bool","required":false,"default":false},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"tcp_syn_top"}
      ]
    },
    "tcp_connect_list": {
      "desc": "TCP Connect 지정 포트",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"ports","type":"port_list","required":true},
        {"name":"timing","type":"timing","required":false},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"tcp_connect_list"}
      ]
    },
    "tcp_full_range": {
      "desc": "TCP 전체 포트 스캔(-p-)",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"timing","type":"timing","required":false},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"tcp_full"}
      ]
    },
    "udp_top": {
      "desc": "UDP 상위 N 포트",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"top_n","type":"top_n","required":true},
        {"name":"timing","type":"timing","required":false},
        {"name":"no_ping","type":"bool","required":false,"default":true},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"udp_top"}
      ]
    },
    "service_version": {
      "desc": "서비스 버전 식별",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"ports","type":"port_list","required":true},
        {"name":"timing","type":"timing","required":false},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"service_version"}
      ]
    },
    "os_detect": {
      "desc": "OS 식별",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"timing","type":"timing","required":false},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"os_detect"}
      ]
    },
    "script_vuln": {
      "desc": "NSE vuln 스크립트 실행(+버전 스캔)",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"ports","type":"port_list","required":true},
        {"name":"timing","type":"timing","required":false},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"vuln_scan"}
      ]
    },
    "nse_by_category": {
      "desc": "NSE 카테고리 기반 스크립트 실행",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"ports","type":"port_list","required":false,"default":"1,21,22,23,25,53,80,110,139,143,443,445,3389"},
        {"name":"category","type":"nse_category","required":true},
        {"name":"timing","type":"timing","required":false},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"nse_cat"}
      ]
    },
    "aggressive_profile": {
      "desc": "공격적 프로파일(-A)",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"top_n","type":"top_n","required":true},
        {"name":"timing","type":"timing","required":false},
        {"name":"no_ping","type":"bool","required":false,"default":true},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"aggr"}
      ]
    },
    "banner_grab": {
      "desc": "배너 수집(안전 NSE)",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"ports","type":"port_list","required":true},
        {"name":"timing","type":"timing","required":false},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"banner"}
      ]
    },
    "timing_tune": {
      "desc": "타이밍·재시도/속도 미세조정",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"top_n","type":"top_n","required":true},
        {"name":"timing","type":"timing","required":false},
        {"name":"min_rate","type":"rate","required":false},
        {"name":"max_rate","type":"rate","required":false},
        {"name":"retries","type":"retry_count","required":false},
        {"name":"host_timeout","type":"seconds","required":false},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"timing"}
      ]
    },
    "ipv6_scan": {
      "desc": "IPv6 스캔(-6)",
      "params": [
        {"name":"targets","type":"ipv6_targets","required":true,"validation":"regex"},
        {"name":"ports","type":"port_list","required":false,"default":"1,22,80,443,3389"},
        {"name":"timing","type":"timing","required":false},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"ipv6_scan"}
      ]
    },
    "exclude_targets": {
      "desc": "타겟 제외(--exclude)",
      "params": [
        {"name":"targets","type":"ip_targets","required":true},
        {"name":"ports","type":"port_list","required":false,"default":"1,21,22,80,443,445,3389"},
        {"name":"exclude","type":"string","required":true,"validation":"regex"},
        {"name":"timing","type":"timing","required":false},
        {"name":"save","type":"bool","required":false,"default":true},
        {"name":"out_prefix","type":"filename","required":false,"default":"exclude_scan"}
      ]
    }
  }
}
